const mineflayer = require('mineflayer')
const { pathfinder, Movements, goals } = require('mineflayer-pathfinder')
const { GoalNear } = goals

const bot = mineflayer.createBot({
  host: 'TESTWorld182.aternos.me',
  port: 53373,
  username: 'bot',
  auth: 'offline',
  version: '1.21.5'
})

bot.loadPlugin(pathfinder)

bot.once('spawn', () => {
  const mcData = require('minecraft-data')(bot.version)
  const defaultMove = new Movements(bot, mcData)
  bot.pathfinder.setMovements(defaultMove)

  wander()
})

function wander() {
  const x = bot.entity.position.x + (Math.random() * 20 - 10)
  const y = bot.entity.position.y
  const z = bot.entity.position.z + (Math.random() * 20 - 10)

  bot.chat(`Wandering to (${x.toFixed(0)}, ${z.toFixed(0)})`)
  bot.pathfinder.setGoal(new GoalNear(x, y, z, 1))

  // Pick a new random spot after reaching this one
  setTimeout(wander, 8000)
}

bot.on('death', () => {
  bot.chat("I died! Respawning...")
})